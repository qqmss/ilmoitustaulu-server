(this.webpackJsonpilmoitustaulu=this.webpackJsonpilmoitustaulu||[]).push([[0],{14:function(e,t,n){e.exports=n(38)},19:function(e,t,n){},20:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),o=n(13),r=n.n(o),c=(n(19),n(2)),u=(n(20),n(3)),i=n.n(u),m="/api/events",s={getAll:function(){return i.a.get(m).then((function(e){return e.data})).then((function(e){return e.forEach((function(e){e.time=new Date(e.time),e.createdTime=new Date(e.createdTime)})),e}))},create:function(e){return i.a.post(m,e).then((function(e){return e.data})).then((function(e){return e&&(e.time=new Date(e.time),e.createdTime=new Date(e.createdTime)),e}))},update:function(e,t){return i.a.put("".concat(m,"/").concat(e),t).then((function(e){return e.data})).then((function(e){return e.time=new Date(e.time),e.createdTime=new Date(e.createdTime),e}))},erase:function(e){return i.a.delete("".concat(m,"/").concat(e))}},d={getAll:function(e){return i.a.get("".concat("/api/events","/").concat(e,"/comments")).then((function(e){return e.data})).then((function(t){return t.forEach((function(t){t.createdTime=new Date(t.createdTime),t.eventId=e})),t}))},create:function(e,t){return i.a.post("".concat("/api/events","/").concat(e,"/comments"),t).then((function(e){return e.data})).then((function(t){return t.createdTime=new Date(t.createdTime),t.eventId=e,t}))},erase:function(e,t){return i.a.delete("".concat("/api/events","/").concat(e,"/comments/").concat(t))}},h=function(e){var t=e.comment,n=e.handleDeleteCommentClick;return l.a.createElement("div",{className:"comment"},l.a.createElement("div",{className:"comment-author"},l.a.createElement("em",null,t.author," ",t.createdTime.toLocaleString()),l.a.createElement("button",{className:"delete-button",onClick:n},"Poista")),l.a.createElement("p",{className:"comment-mesage"},t.message))},E=function(e){var t=e.handleCommentSubmit,n=e.newAuthor,a=e.setNewAuthor,o=e.newMessage,r=e.setNewMessage;return e.commentFormEventId===e.eventId?l.a.createElement("form",{onSubmit:t,className:"comment-form"},l.a.createElement("fieldset",null,l.a.createElement("legend",null,"Uusi kommentti"),l.a.createElement("label",null,"Nimi tai Nimimerkki:",l.a.createElement("input",{value:n,onChange:function(e){return a(e.target.value)}})),l.a.createElement("label",null,"Viesti:",l.a.createElement("textarea",{value:o,onChange:function(e){return r(e.target.value)}})),l.a.createElement("button",{type:"submit"},"L\xe4het\xe4"))):null},f=function(e){var t=e.comments,n=e.eventId,a=e.setCommentFormEventId,o=e.commentFormEventId,r=e.handleCommentSubmit,c=e.newAuthor,u=e.setNewAuthor,i=e.newMessage,m=e.setNewMessage,s=e.handleDeleteCommentClick;return l.a.createElement("div",null,t.map((function(e){return l.a.createElement(h,{key:e.id,comment:e,handleDeleteCommentClick:function(){return s(n,e.id)}})})),l.a.createElement("button",{onClick:function(){return a(o!==n?n:"")}},"Lis\xe4\xe4 kommentti"),l.a.createElement(E,{handleCommentSubmit:r,newAuthor:c,setNewAuthor:u,newMessage:i,setNewMessage:m,commentFormEventId:o,eventId:n}))},v=function(e){var t=e.events,n=e.comments,a=e.handleShowEventClick,o=e.handleJoinEventClick,r=e.handleDeleteEventClick,c=e.eventsToShowDetails,u=e.setCommentFormEventId,i=e.commentFormEventId,m=e.handleCommentSubmit,s=e.newAuthor,d=e.setNewAuthor,h=e.newMessage,E=e.setNewMessage,f=e.handleDeleteCommentClick;return t.map((function(e){return l.a.createElement(w,{key:e.id,event:e,comments:n,handleShowEventClick:function(){return a(e.id)},handleJoinEventClick:function(){return o(e.id)},handleDeleteEventClick:function(){return r(e.id)},eventsToShowDetails:c,setCommentFormEventId:u,commentFormEventId:i,handleCommentSubmit:m,newAuthor:s,setNewAuthor:d,newMessage:h,setNewMessage:E,handleDeleteCommentClick:f})}))},w=function(e){var t=e.event,n=e.comments,a=e.handleShowEventClick,o=e.handleJoinEventClick,r=e.handleDeleteEventClick,c=e.eventsToShowDetails,u=e.setCommentFormEventId,i=e.commentFormEventId,m=e.handleCommentSubmit,s=e.newAuthor,d=e.setNewAuthor,h=e.newMessage,E=e.setNewMessage,f=e.handleDeleteCommentClick;return c.includes(t.id)?l.a.createElement("tr",null,l.a.createElement(C,{event:t,comments:n,handleShowEventClick:a,handleJoinEventClick:o,handleDeleteEventClick:r,setCommentFormEventId:u,commentFormEventId:i,handleCommentSubmit:m,newAuthor:s,setNewAuthor:d,newMessage:h,setNewMessage:E,handleDeleteCommentClick:f})):l.a.createElement("tr",{onClick:a},l.a.createElement("td",null,t.name),l.a.createElement("td",null,t.location),l.a.createElement("td",null,t.time.toLocaleDateString()))},C=function(e){var t=e.event,n=e.comments,a=e.handleShowEventClick,o=e.handleJoinEventClick,r=e.handleDeleteEventClick,c=e.setCommentFormEventId,u=e.commentFormEventId,i=e.handleCommentSubmit,m=e.newAuthor,s=e.setNewAuthor,d=e.newMessage,h=e.setNewMessage,E=e.handleDeleteCommentClick;return l.a.createElement("td",{colSpan:"3"},l.a.createElement("h2",{className:"details-header",onClick:a},t.name),l.a.createElement("div",{className:"created-time"},"Luotu: ",t.createdTime.toLocaleString(),l.a.createElement("br",null),l.a.createElement("button",{className:"delete-button",onClick:r},"Poista")),l.a.createElement("h3",null,"Paikka"),l.a.createElement("p",null,t.location),l.a.createElement("h3",null,"Aika"),l.a.createElement("p",null,t.time.toLocaleString()),l.a.createElement("h3",null,"Kuvaus"),l.a.createElement("p",null,t.description),l.a.createElement("h3",null,"Osallistujat"),l.a.createElement("p",null,t.participants),l.a.createElement("button",{onClick:o},"Osallistu"),l.a.createElement("h3",null,"Kommentit"),l.a.createElement(f,{comments:n.filter((function(e){return e.eventId===t.id})),eventId:t.id,setCommentFormEventId:c,commentFormEventId:u,handleCommentSubmit:i,newAuthor:m,setNewAuthor:s,newMessage:d,setNewMessage:h,handleDeleteCommentClick:E}))},p=function(e){var t=e.events,n=e.comments,a=e.handleShowEventClick,o=e.handleJoinEventClick,r=e.handleDeleteEventClick,c=e.eventsToShowDetails,u=e.setEventsToShowDetails,i=e.setCommentFormEventId,m=e.commentFormEventId,s=e.handleCommentSubmit,d=e.newAuthor,h=e.setNewAuthor,E=e.newMessage,f=e.setNewMessage,w=e.handleDeleteCommentClick;return l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,l.a.createElement("button",{className:"show-all-event-details",onClick:function(){return u(t.map((function(e){return e.id})))}},"N\xe4yt\xe4"),l.a.createElement("button",{className:"show-all-event-details",onClick:function(){return u([])}},"Piilota"),"Tapahtuma"),l.a.createElement("th",null,"Paikka"),l.a.createElement("th",null,"Aika"))),l.a.createElement("tbody",null,l.a.createElement(v,{events:t,comments:n,handleShowEventClick:a,handleJoinEventClick:o,handleDeleteEventClick:r,eventsToShowDetails:c,setCommentFormEventId:i,commentFormEventId:m,handleCommentSubmit:s,newAuthor:d,setNewAuthor:h,newMessage:E,setNewMessage:f,handleDeleteCommentClick:w})))},b=function(e){var t=e.handleEventSubmit,n=e.newName,a=e.setNewName,o=e.newLocation,r=e.setNewLocation,c=e.newTime,u=e.setNewTime,i=e.newDescription,m=e.setNewDescription;return l.a.createElement("form",{onSubmit:t,className:"event-form"},l.a.createElement("fieldset",null,l.a.createElement("legend",null,"Uusi tapahtuma"),l.a.createElement("label",null,"Tapahtuman nimi:",l.a.createElement("input",{value:n,onChange:function(e){return a(e.target.value)}})),l.a.createElement("label",null,"Paikka:",l.a.createElement("input",{value:o,onChange:function(e){return r(e.target.value)}})),l.a.createElement("label",null,"Aika:",l.a.createElement("input",{type:"datetime-local",value:c,onChange:function(e){return u(e.target.value)}})),l.a.createElement("label",null,"Kuvaus:",l.a.createElement("br",null),l.a.createElement("textarea",{value:i,onChange:function(e){return m(e.target.value)}}),l.a.createElement("br",null)),l.a.createElement("button",{type:"submit"},"L\xe4het\xe4")))},k=function(e){var t=e.message,n=e.setErrorMessage;return null===t?null:l.a.createElement("div",{className:"error-notification"},t,l.a.createElement("button",{onClick:function(){return n(null)}},"Sulje"))},g=function(e){var t=e.message,n=e.setSuccessMessage;return null===t?null:l.a.createElement("div",{className:"success-notification"},t,l.a.createElement("button",{onClick:function(){return n(null)}},"Sulje"))};var N=function(){var e=Object(a.useState)(""),t=Object(c.a)(e,2),n=t[0],o=t[1],r=Object(a.useState)(""),u=Object(c.a)(r,2),i=u[0],m=u[1],h=Object(a.useState)(""),E=Object(c.a)(h,2),f=E[0],v=E[1],w=Object(a.useState)(""),C=Object(c.a)(w,2),N=C[0],S=C[1],T=Object(a.useState)(""),D=Object(c.a)(T,2),A=D[0],I=D[1],j=Object(a.useState)(""),O=Object(c.a)(j,2),M=O[0],F=O[1],L=Object(a.useState)(""),y=Object(c.a)(L,2),J=y[0],P=y[1],x=Object(a.useState)([]),K=Object(c.a)(x,2),U=K[0],B=K[1],V=Object(a.useState)([]),q=Object(c.a)(V,2),z=q[0],G=q[1],H=Object(a.useState)([]),Q=Object(c.a)(H,2),R=Q[0],W=Q[1],X=Object(a.useState)(null),Y=Object(c.a)(X,2),Z=Y[0],$=Y[1],_=Object(a.useState)(null),ee=Object(c.a)(_,2),te=ee[0],ne=ee[1];return Object(a.useEffect)((function(){s.getAll().then((function(e){return G(e)}))}),[]),Object(a.useEffect)((function(){I(""),F("")}),[J]),l.a.createElement("div",{className:"App"},l.a.createElement("div",{className:"notification"},l.a.createElement(k,{message:Z,setErrorMessage:$}),l.a.createElement(g,{message:te,setSuccessMessage:ne})),l.a.createElement("h1",null,"Ilmoitustaulu"),l.a.createElement(p,{events:z,comments:R,handleShowEventClick:function(e){U.includes(e)?B(U.filter((function(t){return t!==e}))):(B(U.concat(e)),R.some((function(t){return t.eventId===e}))||d.getAll(e).then((function(e){W(R.concat(e))})))},handleJoinEventClick:function(e){var t=z.find((function(t){return t.id===e})).participants;s.update(e,{participants:t+1}).then((function(e){G(z.map((function(t){return t.id!==e.id?t:e}))),ne('Osallistuit tapahtumaan "'.concat(e.name,'".')),window.setTimeout((function(){return ne(null)}),5e3)})).catch((function(t){console.log(t.response.data.error),404===t.response.status?($("Tapahtuma ".concat(z.find((function(t){return t.id===e})).name," oli poistettu palvelimelta")),window.setTimeout((function(){return $(null)}),5e3),G(z.filter((function(t){return t.id!==e})))):($(t.response.data.error),window.setTimeout((function(){return $(null)}),5e3))}))},handleDeleteEventClick:function(e){s.erase(e).then((function(){ne("Tapahtuma ".concat(z.find((function(t){return t.id===e})).name," poistettu.")),window.setTimeout((function(){return ne(null)}),5e3),G(z.filter((function(t){return t.id!==e}))),B(U.filter((function(t){return t!==e})))})).catch((function(e){$(e.response.data.error),window.setTimeout((function(){return $(null)}),5e3)}))},eventsToShowDetails:U,setEventsToShowDetails:B,setCommentFormEventId:P,commentFormEventId:J,handleCommentSubmit:function(e){e.preventDefault();var t={author:A,message:M};d.create(J,t).then((function(e){W(R.concat(e)),I(""),F("")})).catch((function(e){console.log(e.response.data.error),404===e.response.status?($("Tapahtuma ".concat(z.find((function(e){return e.id===J})).name," oli poistettu palvelimelta.")),window.setTimeout((function(){return $(null)}),5e3),G(z.filter((function(e){return e.id!==J})))):400===e.response.status?($("T\xe4yt\xe4 uuden kommentin kent\xe4t"),window.setTimeout((function(){return $(null)}),5e3)):($(e.response.data.error),window.setTimeout((function(){return $(null)}),5e3))}))},newAuthor:A,setNewAuthor:I,newMessage:M,setNewMessage:F,handleDeleteCommentClick:function(e,t){d.erase(e,t).then((function(){return W(R.filter((function(e){return e.id!==t})))})).catch((function(t){console.log(t.response.data.error),404===t.response.status?($("Tapahtuma ".concat(z.find((function(t){return t.id===e})).name," oli poistettu palvelimelta.")),window.setTimeout((function(){return $(null)}),5e3),G(z.filter((function(t){return t.id!==e})))):($(t.response.data.error),window.setTimeout((function(){return $(null)}),5e3))}))}}),l.a.createElement(b,{handleEventSubmit:function(e){e.preventDefault();var t={name:n,location:i,time:new Date(f),description:N};s.create(t).then((function(e){G(z.concat(e)),o(""),m(""),v(""),S(""),ne("Tapahtuma ".concat(e.name," luotu.")),window.setTimeout((function(){return ne(null)}),5e3)})).catch((function(e){console.log(e.response.data.error),400===e.response.status?($("T\xe4yt\xe4 uuden tapahtuman kent\xe4t"),window.setTimeout((function(){return $(null)}),5e3)):($(e.response.data.error),window.setTimeout((function(){return $(null)}),5e3))}))},newName:n,setNewName:o,newLocation:i,setNewLocation:m,newTime:f,setNewTime:v,newDescription:N,setNewDescription:S}))};r.a.render(l.a.createElement(N,null),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.3b49ab6b.chunk.js.map